\begin{figure*}[!ht]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{circuitikz}
    \tikzstyle{every node}=[font=\Large]
    
    \draw [ dashed] (8.5,-0.5) rectangle  (18,-6.5);
    \draw [ dashed] (18.25,7.25) rectangle  (21.25,1.25);
    \draw [ dashed] (9.25,7.25) rectangle  (17.25,1.25);
    
    \draw [ fill={rgb,255:red,246; green,245; blue,244} ] (4.25,11.75) rectangle (5.5,10.5);
    \draw [ fill={rgb,255:red,246; green,245; blue,244} ] (4.75,11.25) rectangle (6,10);
    \node [font=\large] at (5,12.25) {Input Data};
    \draw [->, >=Stealth] (6,11) -- (8,11);
    \draw  (8,12.25) rectangle  node {\Huge $\epsilon_{\omega}(x)$} (10.5,9.75);
    \node [font=\large] at (9.5,11.25) {};
    \node [font=\large] at (9,10.5) {};
    \node [font=\large] at (10.5,11.25) {};
    \draw [short] (13.75,11.5) -- (10.5,12.25);
    \draw [short] (10.5,9.75) -- (13.75,10.5);
    \draw  (13.75,11.75) rectangle  node {\LARGE z} (14.5,10);
    
    
    \draw  (17.75,12.25) rectangle  node {\Huge $D_{\rho}(z)$} (20.25,9.75);
    \node [font=\large] at (13.5,6.25) {};
    \node [font=\large] at (13,5.5) {};
    \node [font=\large] at (14.5,6.75) {};
    \draw [short] (17.75,12.25) -- (14.5,11.5);
    \draw [short] (14.5,10.5) -- (17.75,9.75);
    \draw [ dashed] (7.75,13.25) rectangle  (20.5,9);
    \node [font=\Large] at (14,13.75) {Autoencoder};
    \node [font=\large] at (10,12.75) {Encoder Network};
    \node [font=\large] at (18.25,12.75) {Decoder Network};
    \draw [->, >=Stealth] (20.25,11) -- (22.25,11);
    \draw [ fill={rgb,255:red,154; green,153; blue,150} ] (22.75,11.75) rectangle (24,10.5);
    \draw [ fill={rgb,255:red,154; green,153; blue,150} ] (22.25,11.25) rectangle (23.5,10);
    \node [font=\large] at (23,12.25) {Reconstructed Data};
    \draw [<->, >=Stealth, dashed] (5.25,11.75) .. controls (7.5,16.25) and (21.75,15.75) .. (23,11.75)node[pos=0.5, fill=white]{$L_R$};
    \draw  (9.75,5.25) circle (0.25cm);
    \node [font=\huge] at (10,5.25) {};
    \node [font=\huge] at (17.75,51.5) {};
    \draw  (9.75,4.5) circle (0.25cm);
    \node [font=\huge, rotate around={90:(0,0)}] at (9.5,3.75) {...};
    \draw  (9.75,6) circle (0.25cm);
    \draw  (9.75,3) circle (0.25cm);
    \draw  (11,4.5) circle (0.25cm);
    \draw  (11,3.75) circle (0.25cm);
    \draw  (11,5.25) circle (0.25cm);
    \draw  (12.25,4.75) circle (0.25cm);
    \draw  (12.25,4) circle (0.25cm);
    \draw  (12.25,5.5) circle (0.25cm);
    \draw  (13.5,2.5) circle (0.25cm);
    \draw  (13.5,4) circle (0.25cm);
    \draw  (13.5,5.5) circle (0.25cm);
    \draw  (13.5,4.75) circle (0.25cm);
    \draw  (13.5,6.25) circle (0.25cm);
    \draw  (12.25,3.25) circle (0.25cm);
    \draw  (15,7) rectangle (17,1.5);
    \node [font=\large] at (15.75,3) {$\langle Z_i\rangle'$};
    \node [font=\large] at (16,4.25) {$\langle Z_iZ_j\rangle'$};
    \node [font=\large] at (16,5.5) {$\langle Z_iZ_jZ_k\rangle'$};
    \draw [short] (10,6) -- (10.75,5.25);
    \draw [short] (10,6) -- (10.75,4.5);
    \draw [short] (10,6) -- (10.75,3.75);
    \draw [short] (10,5.25) -- (10.75,5.25);
    \draw [short] (10,5.25) -- (10.75,4.5);
    \draw [short] (10,5.25) -- (10.75,3.75);
    \draw [short] (10,4.5) -- (10.75,5.25);
    \draw [short] (10,4.5) -- (10.75,4.5);
    \draw [short] (10,4.5) -- (10.75,3.75);
    \draw [short] (10,3) -- (10.75,5.25);
    \draw [short] (10,3) -- (10.75,4.5);
    \draw [short] (10,3) -- (10.75,3.75);
    \draw [short] (11.25,5.25) -- (12,5.5);
    \draw [short] (11.25,5.25) -- (12,4.75);
    \draw [short] (11.25,5.25) -- (12,4);
    \draw [short] (11.25,5.25) -- (12,3.25);
    \draw [short] (11.25,4.5) -- (12,5.5);
    \draw [short] (11.25,4.5) -- (12,4.75);
    \draw [short] (11.25,4.5) -- (12,4);
    \draw [short] (11.25,4.5) -- (12,3.25);
    \draw [short] (11.25,3.75) -- (12,5.5);
    \draw [short] (11.25,3.75) -- (12,4.75);
    \draw [short] (11.25,3.75) -- (12,4);
    \draw [short] (11.25,3.75) -- (12,3.25);
    \draw [short] (12.5,5.5) -- (13.25,6.25);
    \draw [short] (12.5,5.5) -- (13.25,5.5);
    \draw [short] (12.5,5.5) -- (13.25,4.75);
    \draw [short] (12.5,5.5) -- (13.25,4);
    \draw [short] (12.5,5.5) -- (13.25,2.5);
    \draw [short] (12.5,4.75) -- (13.25,6.25);
    \draw [short] (12.5,4.75) -- (13.25,5.5);
    \draw [short] (12.5,4.75) -- (13.25,4.75);
    \draw [short] (12.5,4.75) -- (13.25,4);
    \draw [short] (12.5,4.75) -- (13.25,2.5);
    \draw [short] (12.5,4) -- (13.25,6.25);
    \draw [short] (12.5,4) -- (13.25,5.5);
    \draw [short] (12.5,4) -- (13.25,4.75);
    \draw [short] (12.5,4) -- (13.25,4);
    \draw [short] (12.5,4) -- (13.25,2.5);
    \draw [short] (12.5,3.25) -- (13.25,6.25);
    \draw [short] (12.5,3.25) -- (13.25,5.5);
    \draw [short] (12.5,3.25) -- (13.25,4.75);
    \draw [short] (12.5,3.25) -- (13.25,4);
    \draw [short] (12.5,3.25) -- (13.25,2.5);
    \node [font=\huge, rotate around={90:(0,0)}] at (13.25,3.25) {...};
    \draw [short] (14,6.25) -- (15,7);
    \draw [short] (14,2.5) -- (15,1.5);
    \draw [short] (14,6.25) -- (14,2.5);
    \node [font=\Large] at (13,7.75) {Quantum Surrogate};
    \draw [ line width=0.5pt ] (9.5,-3.5) circle (0.25cm);
    \node  [waves, right, rotate=90.000] at(9.5,-3.25) {};
    \node  [waves, right, rotate=-90.000] at(9.5,-3.75) {};
    \node [font=\Huge] at (12.75,-3.25) { ...};
    \draw [ line width=0.5pt ] (10.75,-3.5) circle (0.25cm);
    \node  [waves, right, rotate=90.000] at(10.75,-3.25) {};
    \node  [waves, right, rotate=-90.000] at(10.75,-3.75) {};
    \draw [ line width=0.5pt ] (12,-3.5) circle (0.25cm);
    \node  [waves, right, rotate=90.000] at(12,-3.25) {};
    \node  [waves, right, rotate=-90.000] at(12,-3.75) {};
    \draw [ line width=0.5pt ] (13.75,-3.5) circle (0.25cm);
    \node  [waves, right, rotate=90.000] at(13.75,-3.25) {};
    \node  [waves, right, rotate=-90.000] at(13.75,-3.75) {};
    \node [font=\huge] at (14,5.75) {};
    \node [font=\huge] at (14,5.75) {};
    \draw [ line width=0.5pt ] (19,2.5) circle (0.25cm);
    \draw [ line width=0.5pt ] (19,4) circle (0.25cm);
    \node [font=\huge, rotate around={90:(0,0)}] at (18.75,3.25) {...};
    \node [font=\large] at (15.25,-4.25) {};
    \node [font=\large] at (15.25,-4.25) {};
    \node [font=\large] at (15.75,-4.75) {};
    \draw [ line width=0.5pt ] (19,4.75) circle (0.25cm);
    \node [font=\large] at (20,3) {};
    \node [font=\large] at (20,3) {};
    \draw [ line width=0.5pt ] (19,5.5) circle (0.25cm);
    \draw [ line width=0.5pt ] (19,6.25) circle (0.25cm);
    \draw [->, >=Stealth] (17,4.25) -- (18.25,4.25);
    \node [font=\large] at (19.5,3.5) {};
    \node [font=\large] at (19.5,3.5) {};
    \node [font=\large] at (19.5,3.5) {};
    \draw [ line width=0.5pt ] (20.5,3.75) circle (0.25cm);
    \node [font=\large] at (21,3.5) {};
    \node [font=\large] at (20.5,3) {};
    \draw [ line width=0.5pt ] (20.5,5.25) circle (0.25cm);
    \draw [short] (19.25,6.25) -- (20.25,5.25);
    \draw [short] (19.25,6.25) -- (20.25,3.75);
    \draw [short] (19.25,5.5) -- (20.25,5.25);
    \draw [short] (19.25,5.5) -- (20.25,3.75);
    \draw [short] (19.25,4.75) -- (20.25,5.25);
    \draw [short] (19.25,4.75) -- (20.25,3.75);
    \draw [short] (19.25,4) -- (20.25,3.75);
    \draw [short] (19.25,4) -- (20.25,5.25);
    \draw [short] (20.25,3.75) -- (19.25,2.5);
    \draw [short] (20.25,5.25) -- (19.25,2.5);
    \draw [->, >=Stealth] (20.75,5.25) -- (22,4.5);
    \draw [->, >=Stealth] (20.75,3.75) -- (22,4.5);
    \node [font=\large] at (23.25,4.5) {Prediction};
    \draw [->, >=Stealth, dashed] (23,5) -- (23,6.5);
    \node [font=\LARGE] at (23,7) {$L_C$};
    \node [font=\Large] at (19.75,7.75) {Linear Classifier};
    \draw [->, >=Stealth, dashed] (23.75,7) .. controls (25.75,7.25) and (26,7.25) .. (26.5,9);
    \draw [->, >=Stealth, dashed] (14.75,15.25) .. controls (21.25,17) and (26,17) .. (26.5,10);
    \node [font=\LARGE] at (28,9.5) {$L = (1 - \lambda) L_R + \lambda L_C$};
    \draw [->, >=Stealth] (28.5,9) -- (28.5,7.75);
    \node [font=\large] at (28.75,7.25) {Backpropagate};
    \node [font=\large] at (15.5,-1) {};
    \draw  (15.75,-0.75) rectangle (17.75,-6.25);
    \node [font=\large] at (16.5,-4.75) {$\langle Z_i\rangle$};
    \node [font=\large] at (16.75,-3.5) {$\langle Z_iZ_j\rangle$};
    \node [font=\large] at (16.75,-2.25) {$\langle Z_iZ_jZ_k\rangle$};
    \draw [short] (14.75,-1.5) -- (15.75,-0.75);
    \draw [short] (14.75,-5.25) -- (15.75,-6.25);
    \draw [short] (14.75,-1.5) -- (14.75,-5.25);
    \node [font=\huge] at (15,-2) {};
    \node [font=\huge] at (15,-2) {};
    \node [font=\Large] at (13.25,0) {Rydberg Atom Chain Reservoir};
    \draw [->, >=Stealth] (17,1.25) .. controls (21.25,-0.25) and (18.5,-1.75) .. (18,-3.75) node[pos=0.5, fill=white]{Trained on};
    \node [font=\Large] at (14,12.25) {Latent};
    \draw [->, >=Stealth] (14.25,10) .. controls (5.25,8.25) and (9.25,4.5) .. (9.25,4.25) ;
    \draw [->, >=Stealth] (14.25,10) .. controls (5.5,6.25) and (2,3.5) .. (8.5,-3.5) node[pos=0.5, fill=white]{Every N Epochs};
    \end{circuitikz}
    }%
    
    \caption{QGARS: Quantum Guided Autoencoder with Reservoir Surrogate architecture. The system combines a classical autoencoder with a quantum reservoir computing surrogate model to enable end-to-end training.}
    \label{fig:system_architecture}
\end{figure*}